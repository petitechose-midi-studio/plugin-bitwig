; PlatformIO Project Configuration File - Bitwig Plugin
;
; This plugin firmware uses MIDI Studio Core as a library.
; Common build flags and extra_scripts are inherited from core's library.json

[platformio]
default_envs = release

; ============================================================================
; Common settings shared by all environments
; ============================================================================
[env]
framework = arduino
platform = teensy
board = teensy41
board_build.f_cpu = 450000000L
monitor_dtr = 0
monitor_rts = 0

build_flags =
	-D USB_MIDI_SERIAL
	-D TEENSY_OPT_SMALLEST_CODE
	-D LV_CONF_INCLUDE_SIMPLE
	-D LV_LVGL_H_INCLUDE_SIMPLE

extra_scripts =
	pre:script/pio/compiledb.py

; ============================================================================
; Development: uses local repos via symlink (requires repos in ../)
; Usage: pio run -e dev
; ============================================================================
[env:dev]
build_flags =
	${env.build_flags}
	-I ../core/src
	-I ../core/src/config
	-D OC_LOG
lib_deps =
	midi-studio-core=symlink://../core
	oc-ui-lvgl-components=symlink://../../open-control/ui-lvgl-components
	oc-ui-lvgl=symlink://../../open-control/ui-lvgl
	oc-hal-teensy=symlink://../../open-control/hal-teensy
	oc-hal-common=symlink://../../open-control/hal-common
	open-control=symlink://../../open-control/framework

[env:dev-debug]
lib_deps =
	${env:dev.lib_deps}
build_flags =
	${env.build_flags}
	-DDEBUG_LOGS

; ============================================================================
; Release: uses GitHub repos (standalone, no local deps required)
; Usage: pio run -e release
; ============================================================================
[env:release]
lib_deps =
	https://github.com/petitechose-midi-studio/core.git#1.0.0-beta.2
